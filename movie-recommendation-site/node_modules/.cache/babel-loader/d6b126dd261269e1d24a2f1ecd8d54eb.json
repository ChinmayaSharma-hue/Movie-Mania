{"ast":null,"code":"import _slicedToArray from\"E:/Web Dev/project/trydjango/src/movie_db_site/movie-recommendation-site/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),errors=_useState6[0],setErrors=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];useEffect(function(){if(localStorage.getItem('token')!==null){window.location.replace('http://localhost:3000/home');}else{setLoading(false);}},[]);var onSubmit=function onSubmit(e){e.preventDefault();var user={email:email,password:password};fetch('http://127.0.0.1:8000/api/v1/users/auth/login/',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(user)}).then(function(res){return res.json();}).then(function(data){if(data.key){localStorage.clear();localStorage.setItem('token',data.key);window.location.replace('http://localhost:3000/home');}else{setEmail('');setPassword('');localStorage.clear();setErrors(true);}});};return/*#__PURE__*/_jsxs(\"div\",{children:[loading===false&&/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),errors===true&&/*#__PURE__*/_jsx(\"h2\",{children:\"Cannot log in with provided credentials\"}),loading===false&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email address:\"}),\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{name:\"email\",type:\"email\",value:email,required:true,onChange:function onChange(e){return setEmail(e.target.value);}}),' ',/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password:\"}),\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{name:\"password\",type:\"password\",value:password,required:true,onChange:function onChange(e){return setPassword(e.target.value);}}),' ',/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Login\"})]})]});};export default Login;","map":{"version":3,"names":["React","useState","useEffect","Login","email","setEmail","password","setPassword","errors","setErrors","loading","setLoading","localStorage","getItem","window","location","replace","onSubmit","e","preventDefault","user","fetch","method","headers","body","JSON","stringify","then","res","json","data","key","clear","setItem","target","value"],"sources":["E:/Web Dev/project/trydjango/src/movie_db_site/movie-recommendation-site/src/views/auth/Login.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\n\r\nconst Login = () => {\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [errors, setErrors] = useState(false);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        if (localStorage.getItem('token') !== null) {\r\n            window.location.replace('http://localhost:3000/home');\r\n        } else {\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    const onSubmit = e => {\r\n        e.preventDefault();\r\n\r\n        const user = {\r\n            email: email,\r\n            password: password\r\n        };\r\n\r\n        fetch('http://127.0.0.1:8000/api/v1/users/auth/login/', {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify(user)\r\n        })\r\n            .then(res => res.json())\r\n            .then(data => {\r\n                if (data.key) {\r\n                    localStorage.clear();\r\n                    localStorage.setItem('token', data.key);\r\n                    window.location.replace('http://localhost:3000/home');\r\n                } else {\r\n                    setEmail('');\r\n                    setPassword('');\r\n                    localStorage.clear();\r\n                    setErrors(true);\r\n                }\r\n            });\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            {loading === false && <h1>Login</h1>}\r\n            {errors === true && <h2>Cannot log in with provided credentials</h2>}\r\n            {loading === false && (\r\n                <form onSubmit={onSubmit}>\r\n                    <label htmlFor='email'>Email address:</label> <br />\r\n                    <input\r\n                        name='email'\r\n                        type='email'\r\n                        value={email}\r\n                        required\r\n                        onChange={e => setEmail(e.target.value)}\r\n                    />{' '}\r\n                    <br />\r\n                    <label htmlFor='password'>Password:</label> <br />\r\n                    <input\r\n                        name='password'\r\n                        type='password'\r\n                        value={password}\r\n                        required\r\n                        onChange={e => setPassword(e.target.value)}\r\n                    />{' '}\r\n                    <br />\r\n                    <input type='submit' value='Login' />\r\n                </form>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"8JAAA,MAAOA,MAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,C,wFAEA,GAAMC,MAAK,CAAG,QAARA,MAAQ,EAAM,CAChB,cAA0BF,QAAQ,CAAC,EAAD,CAAlC,wCAAOG,KAAP,eAAcC,QAAd,eACA,eAAgCJ,QAAQ,CAAC,EAAD,CAAxC,yCAAOK,QAAP,eAAiBC,WAAjB,eACA,eAA4BN,QAAQ,CAAC,KAAD,CAApC,yCAAOO,MAAP,eAAeC,SAAf,eACA,eAA8BR,QAAQ,CAAC,IAAD,CAAtC,yCAAOS,OAAP,eAAgBC,UAAhB,eAEAT,SAAS,CAAC,UAAM,CACZ,GAAIU,YAAY,CAACC,OAAb,CAAqB,OAArB,IAAkC,IAAtC,CAA4C,CACxCC,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,4BAAxB,EACH,CAFD,IAEO,CACHL,UAAU,CAAC,KAAD,CAAV,CACH,CACJ,CANQ,CAMN,EANM,CAAT,CAQA,GAAMM,SAAQ,CAAG,QAAXA,SAAW,CAAAC,CAAC,CAAI,CAClBA,CAAC,CAACC,cAAF,GAEA,GAAMC,KAAI,CAAG,CACThB,KAAK,CAAEA,KADE,CAETE,QAAQ,CAAEA,QAFD,CAAb,CAKAe,KAAK,CAAC,gDAAD,CAAmD,CACpDC,MAAM,CAAE,MAD4C,CAEpDC,OAAO,CAAE,CACL,eAAgB,kBADX,CAF2C,CAKpDC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeN,IAAf,CAL8C,CAAnD,CAAL,CAOKO,IAPL,CAOU,SAAAC,GAAG,QAAIA,IAAG,CAACC,IAAJ,EAAJ,EAPb,EAQKF,IARL,CAQU,SAAAG,IAAI,CAAI,CACV,GAAIA,IAAI,CAACC,GAAT,CAAc,CACVnB,YAAY,CAACoB,KAAb,GACApB,YAAY,CAACqB,OAAb,CAAqB,OAArB,CAA8BH,IAAI,CAACC,GAAnC,EACAjB,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,4BAAxB,EACH,CAJD,IAIO,CACHX,QAAQ,CAAC,EAAD,CAAR,CACAE,WAAW,CAAC,EAAD,CAAX,CACAK,YAAY,CAACoB,KAAb,GACAvB,SAAS,CAAC,IAAD,CAAT,CACH,CACJ,CAnBL,EAoBH,CA5BD,CA8BA,mBACI,uBACKC,OAAO,GAAK,KAAZ,eAAqB,6BAD1B,CAEKF,MAAM,GAAK,IAAX,eAAmB,+DAFxB,CAGKE,OAAO,GAAK,KAAZ,eACG,cAAM,QAAQ,CAAEO,QAAhB,wBACI,cAAO,OAAO,CAAC,OAAf,4BADJ,kBACkD,aADlD,cAEI,cACI,IAAI,CAAC,OADT,CAEI,IAAI,CAAC,OAFT,CAGI,KAAK,CAAEb,KAHX,CAII,QAAQ,KAJZ,CAKI,QAAQ,CAAE,kBAAAc,CAAC,QAAIb,SAAQ,CAACa,CAAC,CAACgB,MAAF,CAASC,KAAV,CAAZ,EALf,EAFJ,CAQO,GARP,cASI,aATJ,cAUI,cAAO,OAAO,CAAC,UAAf,uBAVJ,kBAUgD,aAVhD,cAWI,cACI,IAAI,CAAC,UADT,CAEI,IAAI,CAAC,UAFT,CAGI,KAAK,CAAE7B,QAHX,CAII,QAAQ,KAJZ,CAKI,QAAQ,CAAE,kBAAAY,CAAC,QAAIX,YAAW,CAACW,CAAC,CAACgB,MAAF,CAASC,KAAV,CAAf,EALf,EAXJ,CAiBO,GAjBP,cAkBI,aAlBJ,cAmBI,cAAO,IAAI,CAAC,QAAZ,CAAqB,KAAK,CAAC,OAA3B,EAnBJ,GAJR,GADJ,CA6BH,CAzED,CA2EA,cAAehC,MAAf"},"metadata":{},"sourceType":"module"}